var UXCore=(()=>{var M=Object.defineProperty;var A=(o,t,e)=>t in o?M(o,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):o[t]=e;var E=(o,t,e)=>(A(o,typeof t!="symbol"?t+"":t,e),e);var f=class{constructor(t,e={}){this.container=t,this.trigger=this.container.querySelector(".ux-select-trigger"),this.triggerText=this.trigger.querySelector("span"),this.dropdown=this.container.querySelector(".ux-select-dropdown"),this.optionsContainer=this.container.querySelector(".ux-select-options"),this.originalSelect=this.container.querySelector("select"),this.searchInput=this.container.querySelector(".ux-select-search input"),this.isOpen=!1,this.options=[],this.highlightedIndex=-1,this.isLoading=!1,this.config={url:this.container.dataset.url||e.url||null,valueField:this.container.dataset.valueField||e.valueField||"value",labelField:this.container.dataset.labelField||e.labelField||"label",searchParam:this.container.dataset.searchParam||e.searchParam||"q",minChars:parseInt(this.container.dataset.minChars)||e.minChars||0,debounce:parseInt(this.container.dataset.debounce)||e.debounce||300,...e},this.debounceTimer=null,this._boundOptionClick=null,this.init()}init(){this.trigger.addEventListener("click",t=>{t.stopPropagation(),this.toggle()}),document.addEventListener("click",t=>{this.container.contains(t.target)||this.close()}),this.searchInput&&(this.searchInput.addEventListener("input",t=>this.handleSearch(t.target.value)),this.searchInput.addEventListener("keydown",t=>{t.key!=="Escape"&&t.stopPropagation()})),this.container.addEventListener("keydown",t=>this.handleKeyboard(t)),this.optionsContainer.addEventListener("click",t=>{let e=t.target.closest(".ux-select-option");e&&this.selectOption(e)}),this.optionsContainer.addEventListener("mouseover",t=>{let e=t.target.closest(".ux-select-option");if(e){let s=Array.from(this.optionsContainer.querySelectorAll(".ux-select-option")).indexOf(e);this.highlightOption(s)}}),this.refreshOptions(),this.config.url&&this.config.minChars===0&&this.fetchOptions("")}refreshOptions(){this.options=Array.from(this.optionsContainer.querySelectorAll(".ux-select-option"))}toggle(){this.isOpen?this.close():this.open()}open(){this.isOpen=!0,this.container.classList.add("is-open"),this.trigger.setAttribute("aria-expanded","true"),this.searchInput&&setTimeout(()=>this.searchInput.focus(),50)}close(){this.isOpen=!1,this.container.classList.remove("is-open"),this.trigger.setAttribute("aria-expanded","false"),this.resetHighlight()}selectOption(t){this.options.forEach(i=>i.classList.remove("is-selected")),t.classList.add("is-selected");let e=t.dataset.value,s=t.textContent.trim();this.triggerText.textContent=s,this.container.dataset.value=e,this.originalSelect&&(this.originalSelect.value=e,this.originalSelect.dispatchEvent(new Event("change"))),this.container.dispatchEvent(new CustomEvent("ux-select:change",{detail:{value:e,label:s}})),this.close(),this.trigger.focus()}highlightOption(t){this.options=Array.from(this.optionsContainer.querySelectorAll(".ux-select-option")),this.options.forEach(e=>e.classList.remove("is-highlighted")),t>=0&&t<this.options.length&&(this.options[t].classList.add("is-highlighted"),this.options[t].scrollIntoView({block:"nearest"}),this.highlightedIndex=t)}resetHighlight(){this.highlightedIndex=-1,this.options.forEach(t=>t.classList.remove("is-highlighted"))}handleSearch(t){this.config.url?t.length>=this.config.minChars&&(clearTimeout(this.debounceTimer),this.debounceTimer=setTimeout(()=>{this.fetchOptions(t)},this.config.debounce)):this.filterOptions(t)}filterOptions(t){t=t.toLowerCase(),this.options.forEach(e=>{let s=e.textContent.toLowerCase();e.style.display=s.includes(t)?"flex":"none"})}async fetchOptions(t){if(!this.isLoading){this.isLoading=!0,this.setLoadingState(!0);try{let e=new URL(this.config.url,window.location.origin);t&&e.searchParams.set(this.config.searchParam,t);let s=await fetch(e.toString());if(!s.ok)throw new Error("Network response was not ok");let i=await s.json();this.renderOptions(i)}catch(e){console.error("UXSelect: Error fetching options",e),this.renderError("Failed to load options")}finally{this.isLoading=!1,this.setLoadingState(!1)}}}renderOptions(t){if(this.optionsContainer.innerHTML="",!Array.isArray(t)||t.length===0){this.optionsContainer.innerHTML=`
                <div class="ux-select-empty" style="padding: 0.75rem; text-align: center; color: var(--ux-color-text-light); font-size: var(--ux-text-sm);">
                    No results found
                </div>
            `,this.options=[];return}t.forEach(e=>{let s=typeof e=="object"?e[this.config.valueField]:e,i=typeof e=="object"?e[this.config.labelField]:e,n=document.createElement("div");n.className="ux-select-option",n.dataset.value=s,n.textContent=i,n.setAttribute("role","option"),this.optionsContainer.appendChild(n)}),this.refreshOptions()}renderError(t){this.optionsContainer.innerHTML=`
            <div class="ux-select-error" style="padding: 0.75rem; text-align: center; color: var(--ux-color-error); font-size: var(--ux-text-sm);">
                ${t}
            </div>
        `,this.options=[]}setLoadingState(t){t&&(this.optionsContainer.innerHTML=`
                <div class="ux-select-loading" style="padding: 0.75rem; text-align: center; color: var(--ux-color-text-light); font-size: var(--ux-text-sm);">
                    <svg width="20" height="20" viewBox="0 0 24 24" style="animation: ux-spin 1s linear infinite; margin: 0 auto;">
                        <circle cx="12" cy="12" r="10" stroke="currentColor" stroke-width="3" fill="none" stroke-dasharray="32" stroke-linecap="round"/>
                    </svg>
                </div>
            `)}setValue(t){let e=this.options.find(s=>s.dataset.value===t);e&&this.selectOption(e)}getValue(){return this.container.dataset.value||null}setOptions(t){this.renderOptions(t)}handleKeyboard(t){if(!this.isOpen){(t.key==="Enter"||t.key===" "||t.key==="ArrowDown")&&(t.preventDefault(),this.open());return}switch(t.key){case"ArrowDown":t.preventDefault(),this.highlightOption(this.highlightedIndex+1);break;case"ArrowUp":t.preventDefault(),this.highlightOption(this.highlightedIndex-1);break;case"Enter":t.preventDefault(),this.highlightedIndex!==-1&&this.options[this.highlightedIndex]&&this.selectOption(this.options[this.highlightedIndex]);break;case"Escape":t.preventDefault(),this.close(),this.trigger.focus();break}}};var g=new Map,c=class{constructor(t){this.element=t,this.id=this.element.id,this.modal=this.element.querySelector(".ux-modal"),this.bodyEl=this.element.querySelector(".ux-modal-body"),this.closeButtons=this.element.querySelectorAll("[data-ux-modal-close]"),this.config={url:this.element.dataset.url||null,cache:this.element.dataset.cache!=="false"},this.isLoaded=!1,this.originalContent=this.bodyEl?this.bodyEl.innerHTML:"",this.id&&g.set(this.id,this),this.init()}init(){this.closeButtons.forEach(t=>{t.addEventListener("click",e=>{e.preventDefault(),this.close()})}),this.element.addEventListener("click",t=>{t.target===this.element&&this.close()}),this._escHandler=t=>{t.key==="Escape"&&this.element.classList.contains("is-open")&&this.close()},document.addEventListener("keydown",this._escHandler),this.registerTriggers()}registerTriggers(){document.querySelectorAll(`[data-ux-modal-target="${this.id}"]`).forEach(e=>{e.addEventListener("click",s=>{s.preventDefault();let i=e.dataset.uxModalUrl,n=e.dataset.uxModalImage,a=e.dataset.uxModalTitle;n?this.openImage(n,a):i?this.openAjax(i):this.open()})})}open(){document.body.style.overflow="hidden",this.element.classList.add("is-open"),setTimeout(()=>{let t=this.element.querySelector("button:not(.ux-modal-close), input, select, textarea");t&&t.focus()},100),this.element.dispatchEvent(new CustomEvent("ux-modal:open",{bubbles:!0}))}close(){document.body.style.overflow="",this.element.classList.remove("is-open"),this.element.dispatchEvent(new CustomEvent("ux-modal:close",{bubbles:!0}))}openImage(t,e=""){this.modal&&this.modal.classList.add("ux-modal-image"),this.bodyEl&&(this.bodyEl.innerHTML=`
                <img src="${t}" alt="${e||""}" onload="this.style.opacity=1" style="opacity:0; transition: opacity 0.3s;">
                ${e?`<div class="ux-modal-caption">${e}</div>`:""}
            `),this.open()}async openAjax(t){if(this.config.cache&&this.isLoaded&&this.lastUrl===t){this.open();return}this.setLoading(!0),this.open();try{let e=await fetch(t);if(!e.ok)throw new Error("Failed to load content");let s=e.headers.get("content-type");if(s&&s.includes("application/json")){let i=await e.json();this.setContent(i.content||JSON.stringify(i,null,2)),i.title&&this.setTitle(i.title)}else{let i=await e.text();this.setContent(i)}this.isLoaded=!0,this.lastUrl=t}catch(e){console.error("UXModal: Error loading content",e),this.setError("Failed to load content")}}setContent(t){this.bodyEl&&(this.bodyEl.innerHTML=t)}setTitle(t){let e=this.element.querySelector(".ux-modal-title");e&&(e.textContent=t)}setLoading(t){this.bodyEl&&t&&(this.bodyEl.innerHTML=`
                <div class="ux-modal-loading">
                    <svg width="32" height="32" viewBox="0 0 24 24" fill="none" stroke="currentColor">
                        <circle cx="12" cy="12" r="10" stroke-width="3" stroke-dasharray="32" stroke-linecap="round"/>
                    </svg>
                </div>
            `)}setError(t){this.bodyEl&&(this.bodyEl.innerHTML=`<div class="ux-modal-error">${t}</div>`)}reset(){this.bodyEl&&(this.bodyEl.innerHTML=this.originalContent),this.modal&&this.modal.classList.remove("ux-modal-image"),this.isLoaded=!1}destroy(){document.removeEventListener("keydown",this._escHandler),this.id&&g.delete(this.id)}};c.get=function(o){return g.get(o)};c.open=function(o){let t=g.get(o);return t?(t.open(),t):(console.warn(`UXModal: Modal with id "${o}" not found`),null)};c.close=function(o){let t=g.get(o);return t?(t.close(),t):null};c.create=function(o={}){let{id:t="ux-modal-"+Date.now(),title:e="",content:s="",size:i="",showFooter:n=!0,confirmText:a="Confirm",cancelText:r="Cancel",onConfirm:h=null,onCancel:p=null,onOpen:m=null,onClose:C=null}=o,d=document.createElement("div");d.id=t,d.className="ux-modal-overlay",d.innerHTML=`
        <div class="ux-modal ${i?"ux-modal-"+i:""}">
            ${e?`
                <div class="ux-modal-header">
                    <h3 class="ux-modal-title">${e}</h3>
                    <button class="ux-modal-close" data-ux-modal-close aria-label="Close">
                        <svg width="24" height="24" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"/>
                        </svg>
                    </button>
                </div>
            `:""}
            <div class="ux-modal-body">${s}</div>
            ${n?`
                <div class="ux-modal-footer">
                    <button class="ux-btn" data-ux-modal-cancel>${r}</button>
                    <button class="ux-btn ux-btn-primary" data-ux-modal-confirm>${a}</button>
                </div>
            `:""}
        </div>
    `,document.body.appendChild(d);let u=new c(d),T=d.querySelector("[data-ux-modal-confirm]");T&&T.addEventListener("click",()=>{h&&h(u),u.close()});let S=d.querySelector("[data-ux-modal-cancel]");return S&&S.addEventListener("click",()=>{p&&p(u),u.close()}),m&&d.addEventListener("ux-modal:open",()=>m(u)),d.addEventListener("ux-modal:close",()=>{C&&C(u),setTimeout(()=>{u.destroy(),d.remove()},300)}),u.open(),u};c.image=function(o,t=""){let e=document.createElement("div");e.id="ux-modal-image-"+Date.now(),e.className="ux-modal-overlay",e.innerHTML=`
        <div class="ux-modal ux-modal-image">
            <button class="ux-modal-close" data-ux-modal-close aria-label="Close">
                <svg width="24" height="24" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"/>
                </svg>
            </button>
            <div class="ux-modal-body">
                <img src="${o}" alt="${t||""}" style="opacity:0; transition: opacity 0.3s;" onload="this.style.opacity=1">
                ${t?`<div class="ux-modal-caption">${t}</div>`:""}
            </div>
        </div>
    `,document.body.appendChild(e);let s=new c(e);return e.addEventListener("ux-modal:close",()=>{setTimeout(()=>{s.destroy(),e.remove()},300)}),s.open(),s};c.confirm=function(o,t={}){return new Promise(e=>{c.create({title:t.title||"Confirm",content:`<p>${o}</p>`,size:"sm",confirmText:t.confirmText||"Confirm",cancelText:t.cancelText||"Cancel",onConfirm:()=>e(!0),onCancel:()=>e(!1),onClose:()=>e(!1)})})};c.alert=function(o,t={}){return new Promise(e=>{c.create({title:t.title||"Alert",content:`<p>${o}</p>`,size:"sm",showFooter:!0,confirmText:t.confirmText||"OK",cancelText:"",onConfirm:()=>e(),onClose:()=>e()})})};var v=class{constructor(t){this.element=t,this.items=this.element.querySelectorAll(".ux-accordion-item"),this.allowMultiple=this.element.dataset.allowMultiple==="true",this.init()}init(){this.items.forEach(t=>{let e=t.querySelector(".ux-accordion-header"),s=t.querySelector(".ux-accordion-content");e.addEventListener("click",()=>this.toggle(t)),t.classList.contains("is-open")&&(s.style.maxHeight=s.scrollHeight+"px")})}toggle(t){let e=t.querySelector(".ux-accordion-content"),s=t.classList.contains("is-open");this.allowMultiple||this.items.forEach(i=>{i!==t&&(i.classList.remove("is-open"),i.querySelector(".ux-accordion-content").style.maxHeight="0")}),s?(t.classList.remove("is-open"),e.style.maxHeight="0"):(t.classList.add("is-open"),e.style.maxHeight=e.scrollHeight+"px")}};var x=class{constructor(t){this.element=t,this.tabList=this.element.querySelector(".ux-tabs-list"),this.panelsContainer=this.element.querySelector(".ux-tabs-panels"),this.cache=new Map,this.loadedTabs=new Set,this.init()}get tabs(){return Array.from(this.element.querySelectorAll(".ux-tab"))}get panels(){return Array.from(this.element.querySelectorAll(".ux-tab-panel"))}init(){this.tabList&&this.tabList.addEventListener("click",e=>{let s=e.target.closest(".ux-tab");if(s){let i=this.tabs.indexOf(s);i!==-1&&this.activate(i)}});let t=this.tabs.find(e=>e.classList.contains("is-active"));if(t){let e=this.tabs.indexOf(t),s=t.getAttribute("data-url");s&&!this.loadedTabs.has(e)&&this.loadContent(e,s)}}activate(t){let e=this.tabs,s=this.panels,i=e[t],n=s[t];if(!i||!n)return;let a=i.getAttribute("data-url");if(e.forEach((r,h)=>{r.classList.toggle("is-active",h===t),r.setAttribute("aria-selected",h===t?"true":"false")}),s.forEach((r,h)=>{r.classList.toggle("is-active",h===t)}),a){if(!(i.getAttribute("data-cache")==="false")&&this.loadedTabs.has(t))return;this.loadContent(t,a)}this.element.dispatchEvent(new CustomEvent("ux-tabs:change",{bubbles:!0,detail:{index:t,tab:i,panel:n}}))}async loadContent(t,e){let s=this.panels,i=this.tabs,n=s[t],a=i[t];if(n){this.setLoading(n,!0),this.setTabLoading(a,!0);try{let r=await fetch(e);if(!r.ok)throw new Error(`HTTP ${r.status}`);let h=r.headers.get("content-type")||"",p;if(h.includes("application/json")){let m=await r.json();p=m.content||m.html||JSON.stringify(m,null,2)}else p=await r.text();n.innerHTML=p,this.loadedTabs.add(t),this.cache.set(t,p),this.element.dispatchEvent(new CustomEvent("ux-tabs:loaded",{bubbles:!0,detail:{index:t,tab:a,panel:n,content:p}}))}catch(r){console.error("UXTabs: Error loading content",r),n.innerHTML=`<div class="ux-tabs-error">Failed to load content: ${r.message}</div>`,this.element.dispatchEvent(new CustomEvent("ux-tabs:error",{bubbles:!0,detail:{index:t,tab:a,panel:n,error:r}}))}finally{this.setTabLoading(a,!1)}}}setLoading(t,e){e&&(t.innerHTML=`
                <div class="ux-tabs-loading">
                    <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor">
                        <circle cx="12" cy="12" r="10" stroke-width="3" stroke-dasharray="32" stroke-linecap="round"/>
                    </svg>
                    <span>Loading...</span>
                </div>
            `)}setTabLoading(t,e){if(!t)return;let s=t.querySelector(".ux-tab-spinner");if(e){if(!s){let i=document.createElement("span");i.className="ux-tab-spinner",i.innerHTML=`
                    <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor">
                        <circle cx="12" cy="12" r="10" stroke-width="3" stroke-dasharray="32" stroke-linecap="round"/>
                    </svg>
                `,t.appendChild(i)}t.classList.add("is-loading")}else s&&s.remove(),t.classList.remove("is-loading")}reload(t){let s=this.tabs[t]?.getAttribute("data-url");s&&(this.loadedTabs.delete(t),this.cache.delete(t),this.loadContent(t,s))}reloadAll(){this.loadedTabs.clear(),this.cache.clear();let t=this.tabs.find(e=>e.classList.contains("is-active"));if(t){let e=this.tabs.indexOf(t),s=t.getAttribute("data-url");s&&this.loadContent(e,s)}}setContent(t,e){let s=this.panels[t];s&&(s.innerHTML=e,this.loadedTabs.add(t),this.cache.set(t,e))}getActiveIndex(){return this.tabs.findIndex(t=>t.classList.contains("is-active"))}};var y=class{constructor(t){this.element=t,this.trigger=this.element.querySelector(".ux-dropdown-trigger"),this.menu=this.element.querySelector(".ux-dropdown-menu"),this.init()}init(){this.trigger.addEventListener("click",t=>{t.stopPropagation(),this.toggle()}),document.addEventListener("click",t=>{this.element.contains(t.target)||this.close()}),document.addEventListener("keydown",t=>{t.key==="Escape"&&this.element.classList.contains("is-open")&&this.close()})}toggle(){this.element.classList.toggle("is-open")}open(){this.element.classList.add("is-open")}close(){this.element.classList.remove("is-open")}};var b=class{constructor(t){this.element=t,this.toggle=this.element.querySelector(".ux-navbar-toggle"),this.nav=this.element.querySelector(".ux-navbar-nav"),this.init()}init(){this.toggle&&this.nav&&this.toggle.addEventListener("click",()=>this.toggleNav())}toggleNav(){this.nav.classList.toggle("is-open")}closeNav(){this.nav.classList.remove("is-open")}},w=class{constructor(t){this.element=t,this.id=this.element.id,this.overlay=document.querySelector(`[data-ux-drawer-overlay="${this.id}"]`),this.init()}init(){document.querySelectorAll(`[data-ux-drawer-target="${this.id}"]`).forEach(s=>{s.addEventListener("click",()=>this.open())}),this.element.querySelectorAll("[data-ux-drawer-close]").forEach(s=>{s.addEventListener("click",()=>this.close())}),this.overlay&&this.overlay.addEventListener("click",()=>this.close()),document.addEventListener("keydown",s=>{s.key==="Escape"&&this.element.classList.contains("is-open")&&this.close()})}open(){this.element.classList.add("is-open"),this.overlay&&this.overlay.classList.add("is-open"),document.body.style.overflow="hidden"}close(){this.element.classList.remove("is-open"),this.overlay&&this.overlay.classList.remove("is-open"),document.body.style.overflow=""}};var l=class l{static init(){l.container||(l.container=document.createElement("div"),l.container.className="ux-toast-container",document.body.appendChild(l.container))}static show(t,e={}){l.init();let{type:s="info",duration:i=l.defaultDuration,title:n}=e,a=document.createElement("div");return a.className=`ux-toast ux-toast-${s}`,a.innerHTML=`
            <svg class="ux-toast-icon" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                ${l.getIcon(s)}
            </svg>
            <div class="ux-toast-content">
                ${n?`<strong>${n}</strong><br>`:""}
                ${t}
            </div>
            <button class="ux-toast-close">
                <svg width="16" height="16" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"/>
                </svg>
            </button>
        `,a.querySelector(".ux-toast-close").addEventListener("click",()=>l.dismiss(a)),l.container.appendChild(a),i>0&&setTimeout(()=>l.dismiss(a),i),a}static dismiss(t){t.classList.add("is-leaving"),setTimeout(()=>t.remove(),200)}static getIcon(t){let e={success:'<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"/>',error:'<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"/>',warning:'<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"/>',info:'<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"/>'};return e[t]||e.info}static success(t,e={}){return l.show(t,{...e,type:"success"})}static error(t,e={}){return l.show(t,{...e,type:"error"})}static warning(t,e={}){return l.show(t,{...e,type:"warning"})}static info(t,e={}){return l.show(t,{...e,type:"info"})}};E(l,"container",null),E(l,"defaultDuration",4e3);var L=l;var k=class{constructor(){this.init()}init(){document.addEventListener("DOMContentLoaded",()=>{this.initComponents()})}initComponents(){document.querySelectorAll(".ux-select-container").forEach(t=>new f(t)),document.querySelectorAll(".ux-modal-overlay").forEach(t=>new c(t)),document.querySelectorAll(".ux-accordion").forEach(t=>new v(t)),document.querySelectorAll(".ux-tabs").forEach(t=>new x(t)),document.querySelectorAll(".ux-dropdown").forEach(t=>new y(t)),document.querySelectorAll(".ux-navbar").forEach(t=>new b(t)),document.querySelectorAll(".ux-drawer").forEach(t=>new w(t)),console.log("UXCore initialized")}};window.uxCore=new k;window.UXToast=L;window.UXModal=c;})();
